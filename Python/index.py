from bottle import route, run, template, request, static_file
from ghost import Ghost
import json
import urllib2
import sys
import PyQt4
import os.path
import logging
import time
from gevent import monkey; monkey.patch_all()

sys.stdout = sys.stderr
c = 5
ghost = Ghost(download_images = True)

@route('/listingimages/staticimages/homedepot/<filename>')
def server_static_listingimages(filename):
    return static_file(filename, root='C:/Git/DID/Python/listingimages/staticimages/homedepot')

@route('/listingimages/Retailers/HomeDepot/<filename>')
def server_static_listingimages(filename):
    return static_file(filename, root='C:/Git/DID/Python/listingimages/Retailers/HomeDepot')

@route('/static/<filename>')
def server_static(filename):
    return static_file(filename, root='C:/Git/DID/Python/static')

@route('/getpages')
def getpages():

	data = "pagesCallback([{"
	data = data + "pagenumber: 1, image: 'http://localhost:8080/dp_image?page=1'},{"
	data = data + "pagenumber: 2, image: 'http://localhost:8080/dp_image?page=2'},{"
	data = data + "pagenumber: 3, image: 'http://localhost:8080/dp_image?page=3'}])"

	return data

@route('/dp_html')
def dp_html():

	page = request.query['page']
	if page == None:
		page = "1"

	return get_markup(page)

@route('/dp_image')
def dp_image():
    
    start = time.time()
    
    global c
    global ghost

    pn = request.query['page']
    if pn == None:
        pn = "1"
    
    root = 'C:/Git/DID/Python/cache'
    file = "page_" + pn + "_" + str(c) +  ".jpg"

    #if os.path.isfile(root + '/' + file) == False:    
    if True:
        markup = get_markup(pn, True)
        ghost.main_frame.setHtml(markup)
        ghost.wait_for_page_loaded()
        ghost.capture_to(root + '/' + file)

        c = c + 1
     
    end = time.time()
    print str(end - start)        
          
    return static_file(file, root=root)

def get_markup(page, use_file_system=False):
		
    response=""	
    if page == "1":
        response = '{"Label":"Lando\u0027s Cloud City","Image":"/StaticImages/HomeDepot/ourbestvalues_bucket.jpg","Name":"DID template 1","StylePath":"","TemplateID":500191,"TemplateGroupID":500340,"TotalPages":9,"Headers":[{"Message":"DID IV","ID":0}],"Footers":[{"Message":"A NEW HOPE","ID":0}],"DeviceBitmap":7,"ContentGroupTypeID":2,"ContentGroupTypeName":"Landing Page Hero","EventStartDate":"\/Date(1393431000000)\/","EventEndDate":"\/Date(1393646400000)\/","EventPostStartDate":"\/Date(1393431000000)\/","EventPostEndDate":"\/Date(1393646400000)\/","EventStartDateString":"2/26/2014 10:10:00 AM","EventEndDateString":"2/28/2014 10:00:00 PM","EventPostStartDateString":"2/26/2014 10:10:00 AM","EventPostEndDateString":"2/28/2014 10:00:00 PM","Items":[{"AdditionalDealInformation":"","BrandID":-2099997439,"BrandName":"Kohler","DealDescription":"$178","Description":"With its clean, simple design and efficient performance, this Highline water-conserving toilet combines both style and function. An innovative 1.28-gallon flush setting provides significant water savings of up to 16,500 gallons per year, compared to an old 3.5-gallon toilet, without sacrificing performance. This Complete Solution package includes everything necessary for installation.","FinalPrice":178.0000,"Image":"/Retailers/HomeDepot/202705234.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202705234","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"KOHLER Highline Classic The Complete Solution 2-Piece 1.28 GPF Elongated Toilet in White","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":1,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047771717},{"AdditionalDealInformation":"","BrandID":-2099948063,"BrandName":"ST. PAUL","DealDescription":"$159.00","Description":"A rich truffle finish is paired with a coral Colorpoint top in this beautiful Highland vanity. Perfect for any space, this 30 in. wide vanity has ample storage with its large bottom drawer and interior space. The vanity top is non-porous, easy to clean, bacteria and mold resistant.","FinalPrice":159.0000,"Image":"/Retailers/HomeDepot/204599288.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"204599288","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"St. Paul Highland 31 in. Vanity in Truffle with Cast Polymers Vanity Top in Coral","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":2,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2045205418},{"AdditionalDealInformation":"","BrandID":-2099999546,"BrandName":"Ryobi","DealDescription":"$129.00","Description":"The Ryobi 18-Volt ONE+ System introduces the next generation in cordless convenience. This 18-Gauge brad nailer features Airstrike Technology, which eliminates the need for noisy compressors, bulky hoses or expensive gas cartridges. This means faster setup and easier maneuvering on the job site. The Ryobi AirStrike P320 18-Gauge 2 in. Brad Nailer Drives 18-Gauge nails from 5/8 in. to 2 in. length. ","FinalPrice":129.0000,"Image":"/Retailers/HomeDepot/203810823.jpg","PostStartDate":"2/27/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"203810823","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"3/5/2014 11:59:59 PM","SaleStartDate":"2/27/2014 12:00:00 AM","Title":"Ryobi One Plus 18-Volt 2 in. 18-Gauge Cordless Brad Nailer","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":3,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041361916},{"AdditionalDealInformation":"","BrandID":-2099999966,"BrandName":"Werner","DealDescription":"$119.00","Description":"For a safe and secure climb up to the gutter that needs cleaning or the window that needs washing, use the Werner 20 ft. Aluminum Extension Ladder. It extends up to 20 ft. so you can get into the attic or up on the roof. The ladder is made of durable aluminum and features spring loaded locks for smooth, secure transitions to different heights. It is lightweight and easy to use.","FinalPrice":119.0000,"Image":"/Retailers/HomeDepot/100664516.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"100664516","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Werner 20 ft. Aluminum Extension Ladder with 225 lb. Load Capacity Type II Duty Rating","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":4,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047805487},{"AdditionalDealInformation":"","BrandID":-2099974259,"BrandName":"Pfister","DealDescription":"$98.00","Description":"A truly versatile design, the Pasadena Collection is a transitional piece that defies definition to complement a variety of decorative settings. Its clean curves and sturdy foundation radiate style, making this fixture a favorable choice for any bathroom decor. Available in a variety of finishes, Pasadena simplifies remodeling by featuring coordinating lavatory faucets with tub and shower products to offer a complete solution for today bathroom upgrade.","FinalPrice":98.0000,"Image":"/Retailers/HomeDepot/202044662.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202044662","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Pfister Pasadena 8 in. Widespread 2-Handle High-Arc Bathroom Faucet in Brushed Nickel","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":5,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047750919},{"AdditionalDealInformation":"","BrandID":-2099999897,"BrandName":"Milwaukee","DealDescription":"$89.00","Description":"The industrys first subcompact hammer drill/driver delivers best-in-class power, speed and durability. For contractors, maintenance technicians, remodelers or anyone whos seeking portability and performance, the compact and lightweight M12 cordless hammer drill/driver gets the job done. It delivers best-in-class 275 in. -lbs. of torque and 0-400/0-1,500 RPM with the REDLITHIUM 12-volt battery (sold separately).The all-metal single-sleeve ratcheting chuck offers superior bit grip, so you wont have to stop for bit retightening or lost bits. An onboard fuel gauge and built-in LED light offer convenience and minimize interruptions, even during prolonged use. The REDLITHIUM Battery Pack (sold separately) delivers more work per charge and more work over pack life than the competitors.","FinalPrice":89.0000,"Image":"/Retailers/HomeDepot/204317434.jpg","PostStartDate":"2/27/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"204317434","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"3/5/2014 11:59:59 PM","SaleStartDate":"2/27/2014 12:00:00 AM","Title":"Milwaukee M12 12-Volt Lithium-Ion 3/8 in. Cordless Hammer Drill/Driver","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":6,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041358671},{"AdditionalDealInformation":"","BrandID":-2099994305,"BrandName":"Glacier Bay","DealDescription":"$88.00","Description":"The Glacier Bay Keelia 1-Handle Pull-Out Kitchen Faucet in Brushed Nickel is constructed of solid brass to ensure long-lasting performance and enjoyment. Its single lever handle meets ADA standards for ease of use in adjusting water temperature and volume. The pull-down sprayer features aerated and wide spray options, as well as a 48 in. braided hose for extended reach, making it ideal for filling large pots and pans or washing down the sink.","FinalPrice":88.0000,"Image":"/Retailers/HomeDepot/202733067.jpg","PostStartDate":"2/27/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"202733067","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"3/5/2014 11:59:59 PM","SaleStartDate":"2/27/2014 12:00:00 AM","Title":"Glacier Bay Keelia 8 in. Single-Handle Pull-Out Sprayer Kitchen Faucet in Brushed Nickel","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":7,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041351421},{"AdditionalDealInformation":"","BrandID":-2099994305,"BrandName":"Glacier Bay","DealDescription":"$88.00","Description":"The Glacier Bay 2-Piece High Efficiency Round Toilet in White is manufactured from durable vitreous china, which is resistant to stains, acid and abrasions for long-lasting beauty. This 2-piece toilet has a separate bowl and tank, and the round bowl can fit easily in most bathrooms. The white color can blend with many bathroom styles. Limited Lifetime Warranty.","FinalPrice":88.0000,"Image":"/Retailers/HomeDepot/202634188.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202634188","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Glacier Bay 2-Piece High Efficiency Round Toilet in White","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":8,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2045142785},{"AdditionalDealInformation":"","BrandID":-2099994305,"BrandName":"Glacier Bay","DealDescription":"$88.00","Description":"The Glacier Bay 2-Piece High Efficiency Round Toilet in White is manufactured from durable vitreous china, which is resistant to stains, acid and abrasions for long-lasting beauty. This 2-piece toilet has a separate bowl and tank, and the round bowl can fit easily in most bathrooms. The white color can blend with many bathroom styles. Limited Lifetime Warranty.","FinalPrice":88.0000,"Image":"/Retailers/HomeDepot/202634188.jpg","PostStartDate":"2/27/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"202634188","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"3/5/2014 11:59:59 PM","SaleStartDate":"2/27/2014 12:00:00 AM","Title":"Glacier Bay 2-Piece High Efficiency Round Toilet in White","TypeID":1,"Url":"","PageIndex":1,"PageID":1,"DisplayOrder":9,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041379194}],"ListingLinks":[{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=202634188&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041379194,"ID":6654523},{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=203810823&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041361916,"ID":6660615},{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=204317434&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041358671,"ID":6672849},{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=202733067&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041351421,"ID":6677008}],"ListingRating":[{"AverageOverallRating":4.4324,"LargeStarImageLocation":"","ListingID":-2047805487,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Werner-20-ft-Aluminum-Extension-Ladder-with-225-lb-Load-Capacity-Type-II-Duty-Rating-D1220-2/100664516","RecommendedCount":33,"SmallStarImageLocation":"","TotalReviewCount":37,"WriteReviewURL":"","ID":-2047805487},{"AverageOverallRating":4.134,"LargeStarImageLocation":"","ListingID":-2047771717,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/KOHLER-Highline-Classic-The-Complete-Solution-2-piece-1-28-GPF-Elongated-Toilet-in-White-K-11499-0/202705234","RecommendedCount":162,"SmallStarImageLocation":"","TotalReviewCount":209,"WriteReviewURL":"","ID":-2047771717},{"AverageOverallRating":4.1048,"LargeStarImageLocation":"","ListingID":-2047750919,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Pfister-Pasadena-8-in-Widespread-2-Handle-High-Arc-Bathroom-Faucet-in-Brushed-Nickel-F-049-PDKK/202044662","RecommendedCount":78,"SmallStarImageLocation":"","TotalReviewCount":105,"WriteReviewURL":"","ID":-2047750919},{"AverageOverallRating":1,"LargeStarImageLocation":"","ListingID":-2045205418,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/prel80/HDUS/EN_US/diy_main/pg_diy.jsp?prod_id=204599288","RecommendedCount":0,"SmallStarImageLocation":"","TotalReviewCount":1,"WriteReviewURL":"","ID":-2045205418},{"AverageOverallRating":4.0148,"LargeStarImageLocation":"","ListingID":-2045142785,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Glacier-Bay-2-Piece-High-Efficiency-Round-Toilet-in-White-N2428RB-N2428T/202634188","RecommendedCount":103,"SmallStarImageLocation":"","TotalReviewCount":135,"WriteReviewURL":"","ID":-2045142785},{"AverageOverallRating":4.0148,"LargeStarImageLocation":"","ListingID":-2041379194,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Glacier-Bay-2-Piece-High-Efficiency-Round-Toilet-in-White-N2428RB-N2428T/202634188","RecommendedCount":103,"SmallStarImageLocation":"","TotalReviewCount":135,"WriteReviewURL":"","ID":-2041379194},{"AverageOverallRating":4.7633,"LargeStarImageLocation":"","ListingID":-2041361916,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-One-Plus-18-Volt-2-in-18-Gauge-Cordless-Brad-Nailer-P320/203810823","RecommendedCount":190,"SmallStarImageLocation":"","TotalReviewCount":207,"WriteReviewURL":"","ID":-2041361916},{"AverageOverallRating":4,"LargeStarImageLocation":"","ListingID":-2041358671,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Milwaukee-M12-12-Volt-Lithium-Ion-3-8-in-Cordless-Hammer-Drill-Driver-2408-20/204317434","RecommendedCount":2,"SmallStarImageLocation":"","TotalReviewCount":2,"WriteReviewURL":"","ID":-2041358671},{"AverageOverallRating":2.1613,"LargeStarImageLocation":"","ListingID":-2041351421,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Glacier-Bay-Keelia-8-in-Single-Handle-Pull-Out-Sprayer-Kitchen-Faucet-in-Brushed-Nickel-FP4A4066BNV/202733067","RecommendedCount":7,"SmallStarImageLocation":"","TotalReviewCount":31,"WriteReviewURL":"","ID":-2041351421}],"ID":500191}'
    elif page == "2":
        response = '{"Label":"Lando\u0027s Cloud City","Image":"/StaticImages/HomeDepot/ourbestvalues_bucket.jpg","Name":"DID template 2","StylePath":"","TemplateID":500192,"TemplateGroupID":500340,"TotalPages":9,"Headers":[{"Message":"DID IV","ID":0}],"Footers":[{"Message":"A NEW HOPE","ID":0}],"DeviceBitmap":7,"ContentGroupTypeID":2,"ContentGroupTypeName":"Landing Page Hero","EventStartDate":"\/Date(1393431000000)\/","EventEndDate":"\/Date(1393646400000)\/","EventPostStartDate":"\/Date(1393431000000)\/","EventPostEndDate":"\/Date(1393646400000)\/","EventStartDateString":"2/26/2014 10:10:00 AM","EventEndDateString":"2/28/2014 10:00:00 PM","EventPostStartDateString":"2/26/2014 10:10:00 AM","EventPostEndDateString":"2/28/2014 10:00:00 PM","Items":[{"AdditionalDealInformation":"","BrandID":-2099999899,"BrandName":"Delta","DealDescription":"$79.00","Description":"The Delta Porter 4 in. 2-Handle High Arc Bathroom Faucet in Oil-Rubbed Bronze features a 2-handle lever design and 1/4-turn handle stops for ease of use. The faucet\u0027s high-arc spout and oil-rubbed bronze finish provide a stylish look to help complement your home decor. This faucet also offers interchangeable hot and cold stems, a pop-up drain assembly and a WaterSense certification to help reduce water use.","FinalPrice":79.0000,"Image":"/Retailers/HomeDepot/202790488.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202790488","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Delta Porter 4 in. Centerset 2-Handle High Arc Bathroom Faucet in Oil Rubbed Bronze","TypeID":1,"Url":"","PageIndex":2,"PageID":2,"DisplayOrder":1,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500192,"RetailerTemplateName":"DID template 2","RetailerTemplateStylePath":"","UPC":"","ID":-2047774161},{"AdditionalDealInformation":"","BrandID":-2099999376,"BrandName":"Moen","DealDescription":"$79.00","Description":"The MOEN Banbury 4 in. 2-Handle High-arc Bathroom Faucet in Brushed Nickel features a Spot Resist finish that is resistant to fingerprints and water spots for easy cleaning and long-lasting enjoyment. The separate lever handles for hot and cold water meet ADA requirements for easy use, and the faucet is WaterSense certified to help reduce water use without compromising performance.","FinalPrice":79.0000,"Image":"/Retailers/HomeDepot/202542498.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202542498","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"MOEN Banbury 4 in. 2-Handle High-arc Bathroom Faucet in Spot Resist Nickel","TypeID":1,"Url":"","PageIndex":2,"PageID":2,"DisplayOrder":2,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500192,"RetailerTemplateName":"DID template 2","RetailerTemplateStylePath":"","UPC":"","ID":-2047808643},{"AdditionalDealInformation":"","BrandID":-2099999546,"BrandName":"Ryobi","DealDescription":"$69.00","Description":"This drill kit is perfect for drilling holes in wood, metal, plastic, drywall and other materials or securing fasteners like screws and bolts. This is a very versatile tool that is extremely beneficial to every homeowner looking to do it themselves. The kit includes one 18-volt Ni-Cd ONE+ battery and a 1-hour dual chemistry charger. The drill features a 1,600 RPM speed with variable speed settings to accommodate each job you tackle.","FinalPrice":69.0000,"Image":"/Retailers/HomeDepot/203466928.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"203466928","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Ryobi 18-Volt One+ Ni-Cad Drill Kit","TypeID":1,"Url":"","PageIndex":2,"PageID":2,"DisplayOrder":3,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500192,"RetailerTemplateName":"DID template 2","RetailerTemplateStylePath":"","UPC":"","ID":-2047844908},{"AdditionalDealInformation":"","BrandID":-2099999546,"BrandName":"Ryobi","DealDescription":"$69.00","Description":"This drill kit is perfect for drilling holes in wood, metal, plastic, drywall and other materials or securing fasteners like screws and bolts. This is a very versatile tool that is extremely beneficial to every homeowner looking to do it themselves. The kit includes one 18-volt Ni-Cd ONE+ battery and a 1-hour dual chemistry charger. The drill features a 1,600 RPM speed with variable speed settings to accommodate each job you tackle.","FinalPrice":69.0000,"Image":"/Retailers/HomeDepot/203466928.jpg","PostStartDate":"2/27/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"203466928","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"3/5/2014 11:59:59 PM","SaleStartDate":"2/27/2014 12:00:00 AM","Title":"Ryobi 18-Volt One+ Ni-Cad Drill Kit","TypeID":1,"Url":"","PageIndex":2,"PageID":2,"DisplayOrder":4,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500192,"RetailerTemplateName":"DID template 2","RetailerTemplateStylePath":"","UPC":"","ID":-2041373853},{"AdditionalDealInformation":"","BrandID":-2099997977,"BrandName":"American Standard","DealDescription":"$68.00","Description":"The Marquette 4 in. 2-Handle Mid-Arc Bathroom Faucet in Satin Nickel offers a timeless design to fit any decor. The Marquette 4 in. bath faucet features the Speed Connect System for simpler and easier bath faucet installation. 2 handles allow for smooth, precise operation and the Marquette 4 in. bath faucet features a limited lifetime warranty on function and finish. The Marquette 4 in. features ceramic disc valves and is ADA-compliant and WaterSense certified to accommodate both your needs and the environment\u0027s.","FinalPrice":68.0000,"Image":"/Retailers/HomeDepot/202879934.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202879934","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"American Standard Marquette 4 in. 2-Handle Bathroom Faucet in Satin Nickel","TypeID":1,"Url":"","PageIndex":2,"PageID":2,"DisplayOrder":5,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500192,"RetailerTemplateName":"DID template 2","RetailerTemplateStylePath":"","UPC":"","ID":-2047794052},{"AdditionalDealInformation":"","BrandID":-2099999966,"BrandName":"Werner","DealDescription":"$62.00","Description":"Use the versatile Werner 6 ft. Fiberglass Step Ladder for indoor and outdoor projects such as window cleaning, hanging decorations and painting. Its fiberglass frame makes it safe for working with electricity. It features a holster top for ready access to tools while you work.","FinalPrice":62.0000,"Image":"/Retailers/HomeDepot/100658411.jpg","PostStartDate":"2/27/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"100658411","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"3/5/2014 11:59:59 PM","SaleStartDate":"2/27/2014 12:00:00 AM","Title":"Werner 6 ft. Fiberglass Step Ladder with 250 lb. Load Capacity Type I Duty Rating","TypeID":1,"Url":"","PageIndex":2,"PageID":2,"DisplayOrder":6,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500192,"RetailerTemplateName":"DID template 2","RetailerTemplateStylePath":"","UPC":"","ID":-2041360661}],"ListingLinks":[{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=203466928&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041373853,"ID":6662001},{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=100658411&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041360661,"ID":6675131}],"ListingRating":[{"AverageOverallRating":3.1765,"LargeStarImageLocation":"","ListingID":-2047844908,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-18-Volt-One-Ni-Cad-Drill-Kit-P852/203466928","RecommendedCount":9,"SmallStarImageLocation":"","TotalReviewCount":17,"WriteReviewURL":"","ID":-2047844908},{"AverageOverallRating":4.5043,"LargeStarImageLocation":"","ListingID":-2047808643,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/MOEN-Banbury-4-in-Centerset-2-Handle-High-arc-Bathroom-Faucet-in-Spot-Resist-Nickel-CA84913SRN/202542498","RecommendedCount":104,"SmallStarImageLocation":"","TotalReviewCount":117,"WriteReviewURL":"","ID":-2047808643},{"AverageOverallRating":4.8077,"LargeStarImageLocation":"","ListingID":-2047794052,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/American-Standard-Marquette-4-in-2-Handle-Bathroom-Faucet-in-Satin-Nickel-7764SF/202879934","RecommendedCount":23,"SmallStarImageLocation":"","TotalReviewCount":26,"WriteReviewURL":"","ID":-2047794052},{"AverageOverallRating":4.4848,"LargeStarImageLocation":"","ListingID":-2047774161,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Delta-Porter-4-in-Centerset-2-Handle-High-Arc-Bathroom-Faucet-in-Oil-Rubbed-Bronze-25984LF-OB/202790488","RecommendedCount":27,"SmallStarImageLocation":"","TotalReviewCount":33,"WriteReviewURL":"","ID":-2047774161},{"AverageOverallRating":3.1765,"LargeStarImageLocation":"","ListingID":-2041373853,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-18-Volt-One-Ni-Cad-Drill-Kit-P852/203466928","RecommendedCount":9,"SmallStarImageLocation":"","TotalReviewCount":17,"WriteReviewURL":"","ID":-2041373853},{"AverageOverallRating":4.7407,"LargeStarImageLocation":"","ListingID":-2041360661,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Werner-6-ft-Fiberglass-Step-Ladder-with-250-lb-Load-Capacity-Type-I-Duty-Rating-FS106/100658411","RecommendedCount":26,"SmallStarImageLocation":"","TotalReviewCount":27,"WriteReviewURL":"","ID":-2041360661}],"ID":500192}'	
    else:
        response = '{"Label":"Lando\u0027s Cloud City","Image":"/StaticImages/HomeDepot/ourbestvalues_bucket.jpg","Name":"DID template 1","StylePath":"","TemplateID":500191,"TemplateGroupID":500340,"TotalPages":9,"Headers":[{"Message":"DID IV","ID":0}],"Footers":[{"Message":"A NEW HOPE","ID":0}],"DeviceBitmap":7,"ContentGroupTypeID":1,"ContentGroupTypeName":"Dynamic Promotion","EventStartDate":"\/Date(1393431000000)\/","EventEndDate":"\/Date(1393646400000)\/","EventPostStartDate":"\/Date(1393431000000)\/","EventPostEndDate":"\/Date(1393646400000)\/","EventStartDateString":"2/26/2014 10:10:00 AM","EventEndDateString":"2/28/2014 10:00:00 PM","EventPostStartDateString":"2/26/2014 10:10:00 AM","EventPostEndDateString":"2/28/2014 10:00:00 PM","Items":[{"AdditionalDealInformation":"","BrandID":-2099997977,"BrandName":"American Standard","DealDescription":"$68.00","Description":"The Marquette 4 in. 2-Handle Mid-Arc Bathroom Faucet in Satin Nickel offers a timeless design to fit any decor. The Marquette 4 in. bath faucet features the Speed Connect System for simpler and easier bath faucet installation. 2 handles allow for smooth, precise operation and the Marquette 4 in. bath faucet features a limited lifetime warranty on function and finish. The Marquette 4 in. features ceramic disc valves and is ADA-compliant and WaterSense certified to accommodate both your needs and the environment\u0027s.","FinalPrice":68.0000,"Image":"/Retailers/HomeDepot/202879934.jpg","PostStartDate":"2/20/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"202879934","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"2/26/2014 11:59:59 PM","SaleStartDate":"2/20/2014 12:00:00 AM","Title":"American Standard Marquette 4 in. 2-Handle Bathroom Faucet in Satin Nickel","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":1,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041882910},{"AdditionalDealInformation":"","BrandID":-2099999546,"BrandName":"Ryobi","DealDescription":"$59.97","Description":"Get twice the value for your money with the Ryobi One+ Nickel Cadmium 18-Volt Batteries (2-Pack). These rechargeable batteries offer a long run time and are compatible with all Ryobi 18-volt One+ power tools.","FinalPrice":59.9700,"Image":"/Retailers/HomeDepot/100086262.jpg","PostStartDate":"2/20/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"100086262","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"2/26/2014 11:59:59 PM","SaleStartDate":"2/20/2014 12:00:00 AM","Title":"Ryobi 18-Volt One+ Ni-Cd Batteries (2-Pack)","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":2,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041851208},{"AdditionalDealInformation":"","BrandID":-2099999546,"BrandName":"Ryobi","DealDescription":"$59.97","Description":"ONE plus delivers more value and performance with this new circular saw. It has a compact design for better handling and left side blade for better cut line visibility. It is equipped with an exact line laser that automatically activates during use to improve cut accuracy. It features the new and improved GripZone overmold for optimum grip and comfort. This saw can make bevel cuts of up to 45 degrees and its electric brake quickly stops the blade for enhanced safety. Like all ONE plus items, this saw works with any 18-Volt ONE plus battery. Upgrade to lithium-ion batteries for lighter weight and more performance.","FinalPrice":59.9700,"Image":"/Retailers/HomeDepot/100052548.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"100052548","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Ryobi 18-Volt One Plus 5-1/2 in. Cordless Circular Saw with Laser (Tool Only)","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":3,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047731614},{"AdditionalDealInformation":"","BrandID":-2099999959,"BrandName":"Hampton Bay","DealDescription":"$49.97","Description":"The Hampton Bay Clarkston 44 in. Ceiling Fan offers a flush-mount design that incorporates clean, transitional styling in white finish and reversible white/bleached oak blades for a stylish look that complements a variety of home decor. The light kit offered is a compliment to any home decor.","FinalPrice":49.9700,"Image":"/Retailers/HomeDepot/203495380.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"203495380","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Hampton Bay Clarkston 44 in. White Ceiling Fan","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":4,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047830136},{"AdditionalDealInformation":"","BrandID":-2099994305,"BrandName":"Glacier Bay","DealDescription":"$49.00","Description":"The Glacier Bay Nevada 24 in. Vanity in White with AB Engineered Composite Vanity Top in White has 2 doors that offer convenient access to an inner storage space that is great for storing bath items and accessories. Constructed of laminated engineered wood, the vanity\u0027s sturdy cabinet has a raised-panel design that offers an elegant look. A cultured marble top with an integral sink and a 2-1/2 in. backsplash help protect your walls from splashes and spills. Coordinates with the Nevada Collection. Limited Lifetime Warranty.","FinalPrice":49.0000,"Image":"/Retailers/HomeDepot/100527212.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"100527212","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Glacier Bay Nevada 24 in. Vanity in White with AB Engineered Composite Vanity Top in White","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":5,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2045117382},{"AdditionalDealInformation":"","BrandID":-2099997247,"BrandName":"Pergo","DealDescription":"$32.60","Description":"Pergo XP Highland Hickory offers an ultra-realistic wood grain finish with premium attached underlayment and PermaMax surface protection for double the wear, double the durability of ordinary laminates. ScratchGuard Advanced provides superior scratch and scuff protection. XP is an AC4 rated product, approved for general commercial traffic; suitable for your home, office, or other light commercial applications such as boutiques and hotel rooms. This rating was designated after being tested for resistance to abrasion, impact, staining and cigarette burns. Each plank is 10mm thick with a 2mm attached underlayment and 4-7/8 in. wide x 47-7/8 in. long. Easy to install, patented PerfectFold joint for a quick and secure installation. Our limited lifetime residential and 5 year light commercial warranty guarantees the floor will not wear, stain or fade. High style made simple. There\u0027s only one Pergo. Wear claim compared to standard AC3 laminate flooring and measured in accordance with NALFA/ANSI LF-01-2011 and/or EN13329:2006+A1:2008.","FinalPrice":32.6000,"Image":"/Retailers/HomeDepot/202882882.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202882882","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Pergo XP Highland Hickory 10mm Thick x 4-7/8 in. Wide x 47-7/8 in. Length Laminate Flooring (13.1...","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":6,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2045142357},{"AdditionalDealInformation":"","BrandID":-2099944255,"BrandName":"CE Tech","DealDescription":"$29.97","Description":"Recharge your mobile device on-the-go with this Power Charger from CE Tech. Fully charged portable power bank provides recharge of 2 smartphones or 1 tablet. Power charger is up to 2 times faster than others on the market. Contents include 1 charging cable and rechargeable 5600 mAh battery.","FinalPrice":29.9700,"Image":"/Retailers/HomeDepot/203718033.jpg","PostStartDate":"2/20/2014 12:00:00 AM","PriceQualifier":"","ProductCode":"203718033","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"2/26/2014 11:59:59 PM","SaleStartDate":"2/20/2014 12:00:00 AM","Title":"CE TECH On-the-Go Power Charger - White","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":7,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2041911799},{"AdditionalDealInformation":"","BrandID":-2099999546,"BrandName":"Ryobi","DealDescription":"$29.97","Description":"ONE+ delivers more value and performance with the smartest charger on the market. It charges all 18V ONE+ batteries in 1 hour or less. The charger has RYOBI patented IntelliPort Technology, which protects battery cells, maximizes battery life, and conserves energy so well it earned an ENERGY STAR rating. The diagnostic read-out provides charging status and even lets you know if the battery is too hot or cold to charge. ","FinalPrice":29.9700,"Image":"/Retailers/HomeDepot/100634343.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"100634343","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Ryobi One+ 18-Volt 30-Minute Dual Chemistry Battery Charger","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":8,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047844433},{"AdditionalDealInformation":"","BrandID":-2099994237,"BrandName":"Lithonia Lighting","DealDescription":"$29.97","Description":"The Lithonia Lighting Diamond Plate 2-Light Chrome Ceiling Fluorescent Shop Light Fixture is ideal for use in workshops, utility rooms and garages. This ceiling light also has a  white acrylic diffuser for tool-free lamp replacement.","FinalPrice":29.9700,"Image":"/Retailers/HomeDepot/202192989.jpg","PostStartDate":"2/19/2014 11:27:27 AM","PriceQualifier":"","ProductCode":"202192989","ProductDescription":"","PromotionTypeID":0,"SaleEndDate":"1/29/2014 11:59:00 PM","SaleStartDate":"1/23/2014 12:00:00 AM","Title":"Lithonia Lighting Diamond Plate 2-Light Chrome Ceiling Fluorescent Shop Light Fixture","TypeID":1,"Url":"","PageIndex":3,"PageID":3,"DisplayOrder":9,"OriginalDeal":"","RetailerTemplateGroupID":500340,"RetailerTemplateID":500191,"RetailerTemplateName":"DID template 1","RetailerTemplateStylePath":"","UPC":"","ID":-2047827920}],"ListingLinks":[{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=203718033&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041911799,"ID":6623179},{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=202879934&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041882910,"ID":6626782},{"DisplayOrder":0,"GridListingOfferID":3,"ImageLocation":"","LinkOption":3,"LinkText":"Add To Cart","LinkType":8,"LinkUrl":"http://www.homedepot.com/webapp/wcs/stores/servlet/OrderItemAdd?storeId=10051&catalogId=10053&langId=-1&catEntryId_1=100086262&quantity_1=1&URL=OrderItemDisplay","Message":null,"ListingID":-2041851208,"ID":6631951}],"ListingRating":[{"AverageOverallRating":4.5943,"LargeStarImageLocation":"","ListingID":-2047844433,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-One-18-Volt-30-Minute-Dual-Chemistry-Battery-Charger-P117/100634343","RecommendedCount":93,"SmallStarImageLocation":"","TotalReviewCount":106,"WriteReviewURL":"","ID":-2047844433},{"AverageOverallRating":4.3438,"LargeStarImageLocation":"","ListingID":-2047830136,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Hampton-Bay-Clarkston-44-in-White-Ceiling-Fan-CF544H-PEH/203495380","RecommendedCount":26,"SmallStarImageLocation":"","TotalReviewCount":32,"WriteReviewURL":"","ID":-2047830136},{"AverageOverallRating":3.5556,"LargeStarImageLocation":"","ListingID":-2047827920,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Lithonia-Lighting-Diamond-Plate-2-Light-Chrome-Ceiling-Fluorescent-Shop-Light-Fixture-1241DP-RE/202192989","RecommendedCount":32,"SmallStarImageLocation":"","TotalReviewCount":54,"WriteReviewURL":"","ID":-2047827920},{"AverageOverallRating":3.8526,"LargeStarImageLocation":"","ListingID":-2047731614,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-18-Volt-One-Plus-5-1-2-in-Cordless-Circular-Saw-with-Laser-Tool-Only-P506/100052548","RecommendedCount":70,"SmallStarImageLocation":"","TotalReviewCount":95,"WriteReviewURL":"","ID":-2047731614},{"AverageOverallRating":3.92,"LargeStarImageLocation":"","ListingID":-2047731614,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/webapp/wcs/stores/servlet/BuildLinkToHomeDepot?linktype=product&id=100052548","RecommendedCount":57,"SmallStarImageLocation":"","TotalReviewCount":75,"WriteReviewURL":"","ID":-2047731614},{"AverageOverallRating":4.5506,"LargeStarImageLocation":"","ListingID":-2045142357,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Pergo-XP-Highland-Hickory-10-mm-Thick-x-4-7-8-in-Wide-x-47-7-8-in-Length-Laminate-Flooring-13-1-sq-ft-case-LF000317/202882882","RecommendedCount":79,"SmallStarImageLocation":"","TotalReviewCount":89,"WriteReviewURL":"","ID":-2045142357},{"AverageOverallRating":4.6462,"LargeStarImageLocation":"","ListingID":-2045142357,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Pergo-XP-Highland-Hickory-10-mm-Thick-x-4-7-8-in-Wide-x-47-7-8-in-Length-Laminate-Flooring-13-1-sq-ft-case-LF000317/202882882","RecommendedCount":59,"SmallStarImageLocation":"","TotalReviewCount":65,"WriteReviewURL":"","ID":-2045142357},{"AverageOverallRating":4.0238,"LargeStarImageLocation":"","ListingID":-2045117382,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Glacier-Bay-Nevada-24-in-Vanity-in-White-with-AB-Engineered-Composite-Vanity-Top-in-White-NE24P2-FD/100527212","RecommendedCount":37,"SmallStarImageLocation":"","TotalReviewCount":42,"WriteReviewURL":"","ID":-2045117382},{"AverageOverallRating":3.5,"LargeStarImageLocation":"","ListingID":-2041911799,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/CE-TECH-On-the-Go-Power-Charger-White-NEW-SKU-50/203718033","RecommendedCount":9,"SmallStarImageLocation":"","TotalReviewCount":16,"WriteReviewURL":"","ID":-2041911799},{"AverageOverallRating":4.8077,"LargeStarImageLocation":"","ListingID":-2041882910,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/American-Standard-Marquette-4-in-2-Handle-Bathroom-Faucet-in-Satin-Nickel-7764SF/202879934","RecommendedCount":23,"SmallStarImageLocation":"","TotalReviewCount":26,"WriteReviewURL":"","ID":-2041882910},{"AverageOverallRating":4.088,"LargeStarImageLocation":"","ListingID":-2041851208,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-18-Volt-One-Ni-Cd-Batteries-2-Pack-P101/100086262","RecommendedCount":202,"SmallStarImageLocation":"","TotalReviewCount":250,"WriteReviewURL":"","ID":-2041851208},{"AverageOverallRating":4.12,"LargeStarImageLocation":"","ListingID":-2041851208,"OverallRatingRange":5,"ProductReviewsURL":"http://www.homedepot.com/p/Ryobi-18-Volt-One-Ni-Cd-Batteries-2-Pack-P101/100086262","RecommendedCount":224,"SmallStarImageLocation":"","TotalReviewCount":275,"WriteReviewURL":"","ID":-2041851208}],"ID":500191}'
    
    data = json.loads(response)
    web_root=''        
    if use_file_system:
        web_root='file:///c:/git/did/python'
    output = template('templates/page', data=data, web_root=web_root)
    return str(output)

def make_pages(pn, c):

    #global c
    global ghost

    root = 'C:/Git/DID/Python/cache'
    file = "page_" + pn + "_" + str(c) +  ".jpg"

    markup = get_markup(pn, True)
    ghost.main_frame.setHtml(markup)
    ghost.wait_for_page_loaded()
    ghost.capture_to(root + '/' + file)
    
run(host='localhost', port=8080, debug=False, server='tornado')

#start = time.time()
#for x in range(0, 600):
#    make_pages("1", x)
#
#end = time.time()
#print str(end - start)